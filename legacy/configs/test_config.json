{
  "project": {
    "name": "ABR_CVAE",
    "description": "Conditional Variational Autoencoder for ABR Signal Generation",
    "version": "1.0.0"
  },
  "data": {
    "raw_data_path": "data/abr_dataset.xlsx",
    "processed_data_path": "data/processed/processed_data_clean.pkl",
    "preprocessing": {
      "save_transformers": true,
      "scaler_path": "data/processed/scaler.pkl",
      "encoder_path": "data/processed/onehot_encoder.pkl",
      "verbose": true
    },
    "dataloader": {
      "batch_size": 32,
      "val_split": 0.2,
      "test_split": 0.1,
      "num_workers": 4,
      "shuffle": true,
      "pin_memory": true,
      "drop_last": false
    }
  },
  "model": {
    "architecture": {
      "latent_dim": 32,
      "predict_peaks": true,
      "num_peaks": 6,
      "encoder": {
        "hidden_dims": [
          512,
          256,
          128
        ],
        "dropout": 0.2,
        "activation": "relu"
      },
      "decoder": {
        "hidden_dims": [
          128,
          256,
          512,
          1024
        ],
        "dropout": 0.2,
        "activation": "relu"
      }
    },
    "initialization": {
      "type": "xavier_normal",
      "gain": 0.1
    }
  },
  "training": {
    "optimizer": {
      "type": "adam",
      "learning_rate": 0.0001,
      "weight_decay": 1e-05,
      "betas": [
        0.9,
        0.999
      ],
      "eps": 1e-07
    },
    "scheduler": {
      "type": "reduce_on_plateau",
      "patience": 5,
      "factor": 0.5,
      "min_lr": 1e-06,
      "verbose": true
    },
    "loss": {
      "beta_scheduler": {
        "type": "linear",
        "max_beta": 1.0,
        "warmup_epochs": 20,
        "decay_rate": 0.1
      },
      "peak_loss_weight": 1.0,
      "use_peak_loss": true,
      "gradient_clip": 0.5
    },
    "epochs": 3,
    "early_stopping": {
      "patience": 15,
      "min_delta": 0.0001,
      "restore_best_weights": true
    },
    "validation": {
      "frequency": 1,
      "compute_metrics": true
    },
    "numerical_stability": {
      "min_logvar": -20.0,
      "max_logvar": 2.0,
      "gradient_clip_value": 0.5,
      "loss_scale": 1.0
    },
    "save_interval": 1
  },
  "evaluation": {
    "checkpoint_path": "checkpoints/best_model.pth",
    "metrics": {
      "reconstruction": {
        "mse": true,
        "mae": true,
        "rmse": true,
        "correlation": true,
        "r_squared": true
      },
      "peaks": {
        "peak_mae": true,
        "peak_correlation": true,
        "peak_presence_accuracy": true,
        "per_peak_metrics": true
      },
      "advanced": {
        "dtw_distance": true,
        "ssim": true,
        "latent_space_quality": true
      }
    },
    "visualization": {
      "signal_reconstruction": {
        "enabled": true,
        "num_samples": 8,
        "save_individual": true,
        "save_grid": true
      },
      "latent_space": {
        "enabled": true,
        "method": "tsne",
        "color_by": [
          "intensity",
          "age",
          "hear_loss"
        ],
        "num_samples": 1000,
        "perplexity": 30,
        "random_state": 42
      },
      "sample_generation": {
        "enabled": true,
        "num_parameter_sets": 6,
        "samples_per_set": 10,
        "show_variability": true
      }
    }
  },
  "inference": {
    "checkpoint_path": "checkpoints/best_model.pth",
    "output_dir": "outputs/inference",
    "generation": {
      "num_samples": 50,
      "batch_size": 10,
      "save_signals": true,
      "save_peaks": true,
      "save_format": "both"
    },
    "static_params": {
      "age_range": [
        20,
        80
      ],
      "intensity_range": [
        60,
        90
      ],
      "stimulus_rate_range": [
        11,
        81
      ],
      "fmp_range": [
        0.1,
        2.0
      ],
      "res_no_range": [
        10,
        200
      ],
      "hear_loss_categories": [
        "Normal",
        "Mild",
        "Moderate",
        "Severe"
      ]
    }
  },
  "logging": {
    "level": "INFO",
    "log_file": "logs/training.log",
    "tensorboard": {
      "enabled": true,
      "log_dir": "runs",
      "comment": "CVAE_ABR_Training"
    },
    "wandb": {
      "enabled": false,
      "project": "abr-cvae",
      "entity": null,
      "tags": [
        "cvae",
        "abr",
        "signal-generation"
      ]
    }
  },
  "checkpoints": {
    "save_dir": "checkpoints",
    "save_frequency": 10,
    "save_best_only": false,
    "monitor": "val_total_loss",
    "mode": "min",
    "filename_template": "epoch_{epoch:03d}_loss_{val_loss:.6f}.pth"
  },
  "outputs": {
    "base_dir": "outputs",
    "plots_dir": "outputs/plots",
    "results_dir": "outputs/results",
    "models_dir": "outputs/models",
    "logs_dir": "logs"
  },
  "device": {
    "type": "auto",
    "gpu_id": 0,
    "mixed_precision": false,
    "benchmark": true
  },
  "reproducibility": {
    "seed": 42,
    "deterministic": false,
    "benchmark": true
  },
  "monitoring": {
    "log_interval": 100,
    "save_sample_reconstructions": true,
    "reconstruction_frequency": 10,
    "num_reconstruction_samples": 4
  }
}