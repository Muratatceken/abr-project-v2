{
  "project": {
    "name": "ABR_CVAE_Ultimate_Maximum",
    "description": "MAXIMUM FEATURE CONFIGURATION - Using ALL advanced components: Hierarchical CVAE + Enhanced Loss + Advanced Schedulers + FiLM + Static Regularization + Joint Generation + InfoNCE + Everything",
    "version": "4.0.0"
  },
  "data": {
    "raw_data_path": "data/abr_dataset.xlsx",
    "processed_data_path": "data/processed/processed_data_categorical_200ts.pkl",
    "preprocessing": {
      "save_transformers": true,
      "scaler_path": "data/processed/scaler.pkl",
      "encoder_path": "data/processed/label_encoder.pkl",
      "verbose": true,
      "signal_length": 200
    },
    "dataloader": {
      "batch_size": 48,
      "val_split": 0.15,
      "test_split": 0.1,
      "num_workers": 8,
      "shuffle": true,
      "pin_memory": true,
      "drop_last": true,
      "normalize_signals": true,
      "normalize_static": true
    }
  },
  "model": {
    "architecture": {
      "signal_length": 200,
      "static_dim": 6,
      "latent_dim": 128,
      "use_hierarchical_model": true,
      "global_latent_dim": 64,
      "local_latent_dim": 64,
      "early_signal_ratio": 0.3,
      "predict_peaks": true,
      "num_peaks": 6,
      "joint_generation": true,
      "use_film": true,
      "model_type": "hierarchical",
      "encoder": {
        "hidden_dims": [1024, 512, 256, 128],
        "dropout": 0.15,
        "activation": "leaky_relu",
        "batch_norm": true,
        "residual_connections": true
      },
      "decoder": {
        "hidden_dims": [128, 256, 512, 1024, 2048],
        "dropout": 0.15,
        "activation": "leaky_relu",
        "batch_norm": true,
        "residual_connections": true,
        "film_hidden_dim": 128
      }
    },
    "initialization": {
      "type": "xavier_uniform",
      "gain": 0.02
    }
  },
  "training": {
    "optimizer": {
      "type": "adamw",
      "learning_rate": 8e-5,
      "weight_decay": 2e-4,
      "betas": [0.9, 0.999],
      "eps": 1e-8,
      "amsgrad": true
    },
    "scheduler": {
      "type": "cosine_annealing_warm_restarts",
      "T_0": 50,
      "T_mult": 1.8,
      "eta_min": 1e-8,
      "warmup_epochs": 30,
      "verbose": true
    },
    "beta_scheduler_type": "hierarchical",
    "beta_scheduler_params": {
      "global_scheduler": {
        "type": "warm_restart",
        "base_scheduler_type": "cosine",
        "base_scheduler_kwargs": {
          "max_beta": 0.6,
          "warmup_epochs": 35
        },
        "restart_interval": 70,
        "restart_multiplier": 1.4
      },
      "local_scheduler": {
        "type": "cyclical",
        "cycle_length": 25,
        "min_beta": 0.2,
        "max_beta": 1.5,
        "wave_type": "cosine"
      }
    },
    "epochs": 300,
    "early_stopping": {
      "patience": 80,
      "min_delta": 1e-6,
      "restore_best_weights": true
    },
    "validation": {
      "frequency": 1,
      "compute_metrics": true
    },
    "gradient_clip": 1.5,
    "log_interval": 25,
    "save_interval": 15,
    "use_enhanced_loss": true,
    "use_hierarchical_loss": true,
    "loss_weights": {
      "reconstruction": 1.0,
      "static_params_reconstruction": 1.2,
      "global_kl": 0.8,
      "local_kl": 1.0,
      "peak_loss": 1.3,
      "alignment_loss": 0.15,
      "static_regularization": 0.9,
      "hierarchical_infonce": 0.25
    },
    "loss_config": {
      "peak_loss_type": "huber",
      "huber_delta": 1.0,
      "alignment_loss_type": "warped_mse",
      "max_warp": 20,
      "temperature": 1.0,
      "use_infonce": true,
      "infonce_temperature": 0.07,
      "use_alignment_loss": true,
      "use_hierarchical_static_loss": true,
      "use_hierarchical_infonce": true,
      "static_loss_weights": {
        "global": 0.4,
        "local": 0.4,
        "combined": 0.2
      },
      "infonce_weights": {
        "global": 0.6,
        "local": 0.4
      }
    },
    "hyperparameter_sweep": {
      "peak_loss_weight": {
        "enabled": true,
        "type": "exponential",
        "start": 0.8,
        "end": 2.2
      },
      "global_kl_weight": {
        "enabled": true,
        "type": "linear",
        "start": 0.4,
        "end": 1.2
      },
      "local_kl_weight": {
        "enabled": true,
        "type": "exponential",
        "start": 0.6,
        "end": 2.0
      },
      "infonce_weight": {
        "enabled": true,
        "type": "linear",
        "start": 0.15,
        "end": 0.4
      },
      "static_reconstruction_weight": {
        "enabled": true,
        "type": "exponential",
        "start": 0.8,
        "end": 1.8
      }
    }
  },
  "static_regularization": {
    "use_static_regularization": true,
    "static_regularization_weight": 0.9,
    "use_infonce_loss": true,
    "infonce_weight": 0.25,
    "infonce_temperature": 0.07
  },
  "enhanced_loss": {
    "use_enhanced_loss": true,
    "use_hierarchical_loss": true,
    "loss_weights": {
      "reconstruction": 1.0,
      "static_params_reconstruction": 1.2,
      "global_kl": 0.8,
      "local_kl": 1.0,
      "peak_loss": 1.3,
      "alignment_loss": 0.15,
      "static_regularization": 0.9,
      "hierarchical_infonce": 0.25
    },
    "loss_config": {
      "peak_loss_type": "huber",
      "huber_delta": 1.0,
      "alignment_loss_type": "warped_mse",
      "max_warp": 20,
      "temperature": 1.0,
      "use_hierarchical_static_loss": true,
      "use_hierarchical_infonce": true,
      "infonce_temperature": 0.07,
      "static_loss_weights": {
        "global": 0.4,
        "local": 0.4,
        "combined": 0.2
      },
      "infonce_weights": {
        "global": 0.6,
        "local": 0.4
      }
    }
  },
  "film_conditioning": {
    "use_film": true,
    "film_config": {
      "hidden_dim": 128,
      "num_layers": 5,
      "activation": "leaky_relu",
      "dropout": 0.1
    }
  },
  "hierarchical_model": {
    "use_hierarchical_model": true,
    "global_latent_dim": 64,
    "local_latent_dim": 64,
    "early_signal_ratio": 0.3,
    "hierarchical_loss_weights": {
      "global_kl": 0.8,
      "local_kl": 1.0,
      "static_global": 0.4,
      "static_local": 0.4,
      "static_combined": 0.2
    },
    "use_hierarchical_regularization": true,
    "hierarchical_regularization_weight": 0.25
  },
  "joint_generation": {
    "enable_joint_generation": true,
    "static_params_reconstruction_weight": 1.2,
    "joint_loss_balance": 0.6,
    "static_params_loss_type": "mse"
  },
  "peak_prediction": {
    "predict_peaks": true,
    "num_peaks": 6,
    "peak_loss_weight": 1.3,
    "peak_loss_type": "huber",
    "use_peak_mask": true,
    "peak_presence_threshold": 0.5,
    "dynamic_peak_scheduling": true
  },
  "advanced_features": {
    "use_residual_connections": true,
    "use_batch_norm": true,
    "use_spectral_norm": false,
    "use_self_attention": false,
    "use_gradient_penalty": false,
    "kl_annealing_cycles": 4,
    "latent_interpolation_weight": 0.15,
    "diversity_loss_weight": 0.08,
    "contrastive_learning": true,
    "temporal_consistency_weight": 0.05
  },
  "inference": {
    "checkpoint_path": "checkpoints_ultimate_maximum/best_model.pth",
    "output_dir": "outputs_ultimate_maximum",
    "generation": {
      "num_samples": 200,
      "batch_size": 30,
      "save_signals": true,
      "save_peaks": true,
      "save_format": "both",
      "test_interpolation": true,
      "interpolation_steps": 25,
      "test_joint_generation": true,
      "hierarchical_sampling": true
    },
    "static_params": {
      "age_range": [18, 85],
      "intensity_range": [55, 95],
      "stimulus_rate_range": [11, 91],
      "fmp_range": [0.05, 2.5],
      "res_no_range": [5, 250],
      "hear_loss_categories": [1, 2, 3, 4, 5, 6]
    }
  },
  "evaluation": {
    "checkpoint_path": "checkpoints_ultimate_maximum/best_model.pth",
    "metrics": {
      "reconstruction": {
        "mse": true,
        "mae": true,
        "rmse": true,
        "correlation": true,
        "r_squared": true,
        "ssim": true
      },
      "peaks": {
        "peak_mae": true,
        "peak_correlation": true,
        "peak_presence_accuracy": true,
        "per_peak_metrics": true,
        "peak_timing_accuracy": true
      },
      "latent_space": {
        "kl_divergence_analysis": true,
        "latent_utilization": true,
        "interpolation_quality": true,
        "hierarchical_disentanglement": true,
        "global_local_separation": true
      },
      "joint_generation": {
        "static_params_accuracy": true,
        "joint_reconstruction_quality": true,
        "parameter_signal_consistency": true
      },
      "advanced": {
        "dtw_distance": true,
        "latent_space_quality": true,
        "generation_diversity": true,
        "interpolation_quality": true,
        "static_reconstruction_quality": true,
        "fid_score": true,
        "inception_score": false,
        "hierarchical_metrics": true,
        "film_conditioning_analysis": true,
        "contrastive_alignment": true
      }
    },
    "visualization": {
      "reconstruction": {
        "enabled": true,
        "num_samples": 30,
        "save_individual": true
      },
      "signal_reconstruction": {
        "enabled": true,
        "num_samples": 30,
        "save_individual": true,
        "save_grid": true,
        "show_peaks": true,
        "show_confidence": true,
        "show_hierarchical_contributions": true,
        "show_film_modulation": true
      },
      "generation": {
        "enabled": true,
        "num_conditions": 5,
        "samples_per_condition": 3
      },
      "latent_space": {
        "enabled": true,
        "method": "both",
        "color_by": ["intensity", "age", "hear_loss", "fmp", "res_no"],
        "num_samples": 8000,
        "perplexity": 120,
        "random_state": 42,
        "separate_hierarchical_plots": true,
        "show_global_local_structure": true
      },
      "sample_generation": {
        "enabled": true,
        "num_parameter_sets": 35,
        "samples_per_set": 40,
        "show_variability": true,
        "interpolation_steps": 60,
        "hierarchical_interpolation": true,
        "joint_generation_samples": true
      },
      "loss_curves": {
        "enabled": true,
        "show_components": true,
        "show_validation": true,
        "smooth_factor": 0.9,
        "show_hierarchical_breakdown": true,
        "show_dynamic_weights": true,
        "show_scheduler_progression": true
      },
      "advanced_analysis": {
        "feature_importance": true,
        "latent_traversal": true,
        "conditioning_effects": true,
        "hierarchical_ablation": true
      }
    }
  },
  "checkpoints": {
    "save_dir": "checkpoints_ultimate_maximum",
    "save_frequency": 15,
    "save_best_only": false,
    "monitor": "val_total_loss",
    "mode": "min",
    "filename_template": "epoch_{epoch:03d}_loss_{val_loss:.6f}.pth",
    "save_optimizer_state": true,
    "save_scheduler_state": true
  },
  "outputs": {
    "base_dir": "outputs_ultimate_maximum",
    "plots_dir": "outputs_ultimate_maximum/plots",
    "results_dir": "outputs_ultimate_maximum/results",
    "models_dir": "outputs_ultimate_maximum/models",
    "logs_dir": "logs"
  },
  "monitoring": {
    "log_interval": 25,
    "save_frequency": 15,
    "plot_frequency": 10,
    "metric_frequency": 5,
    "track_kl_utilization": true,
    "track_hierarchical_metrics": true,
    "track_film_conditioning": true,
    "track_joint_generation": true,
    "track_contrastive_alignment": true
  },
  "logging": {
    "log_level": "INFO",
    "log_file": "logs/training_ultimate_maximum.log",
    "tensorboard_dir": "runs_ultimate_maximum",
    "save_model_summary": true,
    "track_gradients": true,
    "track_weights": true,
    "track_latent_activations": true,
    "track_film_parameters": true,
    "track_hierarchical_separation": true
  },
  "reproducibility": {
    "seed": 42,
    "deterministic": true,
    "benchmark": false
  },
  "device": {
    "type": "auto",
    "use_cuda": true,
    "cuda_device": 0,
    "mixed_precision": false,
    "compile_model": false
  }
} 