2025-08-05 02:43:48,294 INFO    MainThread:20169 [wandb_setup.py:_flush():76] Current SDK version is 0.16.6
2025-08-05 02:43:48,294 INFO    MainThread:20169 [wandb_setup.py:_flush():76] Configure stats pid to 20169
2025-08-05 02:43:48,294 INFO    MainThread:20169 [wandb_setup.py:_flush():76] Loading settings from /Users/muratatceken/.config/wandb/settings
2025-08-05 02:43:48,295 INFO    MainThread:20169 [wandb_setup.py:_flush():76] Loading settings from /Users/muratatceken/Downloads/Projects/abr-project/abr-project-v2/abr-project-v2/wandb/settings
2025-08-05 02:43:48,295 INFO    MainThread:20169 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2025-08-05 02:43:48,295 INFO    MainThread:20169 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2025-08-05 02:43:48,295 INFO    MainThread:20169 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'train.py', 'program_abspath': '/Users/muratatceken/Downloads/Projects/abr-project/abr-project-v2/abr-project-v2/train.py', 'program': '/Users/muratatceken/Downloads/Projects/abr-project/abr-project-v2/abr-project-v2/train.py'}
2025-08-05 02:43:48,295 INFO    MainThread:20169 [wandb_setup.py:_flush():76] Applying login settings: {}
2025-08-05 02:43:48,295 INFO    MainThread:20169 [wandb_setup.py:_flush():76] Applying login settings: {'mode': 'offline'}
2025-08-05 02:43:48,295 INFO    MainThread:20169 [wandb_init.py:_log_setup():521] Logging user logs to /Users/muratatceken/Downloads/Projects/abr-project/abr-project-v2/abr-project-v2/wandb/offline-run-20250805_024348-c76tjivf/logs/debug.log
2025-08-05 02:43:48,295 INFO    MainThread:20169 [wandb_init.py:_log_setup():522] Logging internal logs to /Users/muratatceken/Downloads/Projects/abr-project/abr-project-v2/abr-project-v2/wandb/offline-run-20250805_024348-c76tjivf/logs/debug-internal.log
2025-08-05 02:43:48,295 INFO    MainThread:20169 [wandb_init.py:init():561] calling init triggers
2025-08-05 02:43:48,295 INFO    MainThread:20169 [wandb_init.py:init():568] wandb.init called with sweep_config: {}
config: {'project': {'name': 'ABR_HierarchicalUNet_Diffusion', 'description': 'Hierarchical U-Net with S4 Encoder and Transformer Decoder for ABR Signal Generation', 'version': '1.0.0', 'author': 'AI Assistant', 'experiment_name': 'log_analysis_test'}, 'data': {'dataset_path': 'data/processed/ultimate_dataset_with_clinical_thresholds.pkl', 'signal_length': 200, 'static_dim': 4, 'n_classes': 5, 'splits': {'train_ratio': 0.75, 'val_ratio': 0.15, 'test_ratio': 0.1, 'random_seed': 42}, 'dataloader': {'batch_size': 48, 'num_workers': 6, 'pin_memory': True, 'drop_last': True, 'shuffle_train': True, 'prefetch_factor': 3, 'persistent_workers': True}}, 'model': {'type': 'hierarchical_unet', 'architecture': {'signal_length': 200, 'static_dim': 4, 'base_channels': 80, 'n_levels': 4, 'n_classes': 5, 'dropout': 0.15, 'encoder': {'n_s4_layers': 3, 'd_state': 80, 'use_enhanced_s4': True}, 'decoder': {'n_transformer_layers': 3, 'n_heads': 8, 'use_multi_scale_attention': True, 'use_cross_attention': True}, 'film': {'hidden_dim': 96, 'dropout': 0.15}, 'outputs': {'signal_activation': 'tanh', 'peak_head_dim': 256, 'class_head_dim': 256, 'threshold_head_dim': 256, 'use_attention_heads': True, 'predict_uncertainty': True}}}, 'diffusion': {'noise_schedule': {'type': 'cosine', 'num_timesteps': 1000, 'peak_preserve_ratio': 0.3, 'beta_start': 5e-05, 'beta_end': 0.015}, 'sampling': {'type': 'ddpm', 'ddim_eta': 0.0, 'num_sampling_steps': 50, 'temperature': 1.0, 'clip_denoised': True, 'constraints': {'apply_constraints': True, 'peak_latency_range': [1.0, 8.0], 'amplitude_range': [-0.5, 0.5], 'smooth_kernel_size': 5}}}, 'training': {'optimizer': {'type': 'adamw', 'learning_rate': 0.0002, 'weight_decay': 0.0001, 'betas': [0.9, 0.95], 'eps': 1e-08, 'amsgrad': False}, 'scheduler': {'type': 'cosine_annealing_warm_restarts', 'T_0': 30, 'T_mult': 2, 'eta_min': 5e-07, 'warmup_epochs': 5}, 'epochs': 300, 'gradient_clip': 0.5, 'accumulation_steps': 2, 'log_frequency': 25, 'validation': {'frequency': 1, 'compute_metrics': True}, 'checkpointing': {'save_frequency': 5, 'save_best': True, 'save_last': True, 'save_dir': 'checkpoints'}, 'early_stopping': {'patience': 50, 'min_delta': 1e-05, 'monitor': 'val_total_loss', 'mode': 'min'}}, 'loss': {'type': 'abr_diffusion', 'weights': {'diffusion': 1.0, 'peak_exist': 0.8, 'peak_latency': 1.2, 'peak_amplitude': 1.2, 'classification': 1.5, 'threshold': 1.0}, 'peak_loss_type': 'smooth_l1', 'huber_delta': 0.5, 'class_weights': 'balanced', 'focal_loss': {'use_focal': True, 'alpha': 0.75, 'gamma': 2.5}, 'perceptual': {'use_perceptual': False, 'feature_weights': {'peak_preservation': 2.0, 'morphology': 1.0, 'spectral': 0.5, 'temporal': 1.0}}}, 'evaluation': {'metrics': {'signal_metrics': ['mse', 'mae', 'correlation', 'dtw_distance'], 'peak_metrics': ['peak_mae', 'peak_accuracy', 'existence_f1'], 'classification_metrics': ['accuracy', 'f1_macro', 'f1_weighted', 'confusion_matrix'], 'threshold_metrics': ['threshold_mae', 'threshold_r2']}, 'visualization': {'save_plots': True, 'plot_types': ['reconstruction', 'peaks', 'latent_space', 'generation_samples'], 'n_samples_plot': 10}, 'output_dir': 'outputs/evaluation', 'save_detailed_results': True}, 'inference': {'generation': {'num_samples': 100, 'batch_size': 16, 'temperature': 1.0, 'guidance_scale': 1.0}, 'conditioning': {'age_range': [20, 80], 'intensity_range': [60, 100], 'rate_range': [10, 80], 'fmp_range': [0.5, 1.0]}, 'output_dir': 'outputs/inference', 'save_formats': ['signals', 'peaks', 'predictions', 'metadata']}, 'logging': {'level': 'INFO', 'log_dir': 'logs', 'use_tensorboard': True, 'use_wandb': True, 'wandb': {'project': 'abr-hierarchical-unet', 'entity': None, 'tags': ['diffusion', 'abr', 's4', 'transformer']}}, 'reproducibility': {'seed': 42, 'deterministic': True, 'benchmark': False}, 'hardware': {'device': 'cpu', 'gpu_id': 0, 'mixed_precision': True, 'compile_model': True}, 'paths': {'data_dir': 'data', 'model_dir': 'models', 'checkpoint_dir': '/Users/muratatceken/Downloads/Projects/abr-project/abr-project-v2/abr-project-v2/checkpoints/log_analysis_test', 'output_dir': '/Users/muratatceken/Downloads/Projects/abr-project/abr-project-v2/abr-project-v2/outputs/log_analysis_test', 'log_dir': '/Users/muratatceken/Downloads/Projects/abr-project/abr-project-v2/abr-project-v2/logs/log_analysis_test'}, 'training.epochs': 2, 'data.dataloader.batch_size': 8, 'training.checkpointing.save_frequency': 1, 'training.validation.frequency': 1}
2025-08-05 02:43:48,295 INFO    MainThread:20169 [wandb_init.py:init():611] starting backend
2025-08-05 02:43:48,295 INFO    MainThread:20169 [wandb_init.py:init():615] setting up manager
2025-08-05 02:43:48,297 INFO    MainThread:20169 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=spawn,fork,forkserver, using: spawn
2025-08-05 02:43:48,299 INFO    MainThread:20169 [wandb_init.py:init():623] backend started and connected
2025-08-05 02:43:48,306 INFO    MainThread:20169 [wandb_init.py:init():715] updated telemetry
2025-08-05 02:43:48,345 INFO    MainThread:20169 [wandb_init.py:init():748] communicating run to backend with 90.0 second timeout
2025-08-05 02:43:48,350 INFO    MainThread:20169 [wandb_init.py:init():799] starting run threads in backend
2025-08-05 02:43:54,898 INFO    MainThread:20169 [wandb_run.py:_console_start():2335] atexit reg
2025-08-05 02:43:54,898 INFO    MainThread:20169 [wandb_run.py:_redirect():2190] redirect: wrap_raw
2025-08-05 02:43:54,899 INFO    MainThread:20169 [wandb_run.py:_redirect():2255] Wrapping output streams.
2025-08-05 02:43:54,899 INFO    MainThread:20169 [wandb_run.py:_redirect():2280] Redirects installed.
2025-08-05 02:43:54,899 INFO    MainThread:20169 [wandb_init.py:init():842] run started, returning control to user process
2025-08-05 02:55:15,976 INFO    MainThread:20169 [wandb_run.py:_finish():2064] finishing run abr-hierarchical-unet/c76tjivf
2025-08-05 02:55:15,976 INFO    MainThread:20169 [wandb_run.py:_atexit_cleanup():2304] got exitcode: 0
2025-08-05 02:55:15,976 INFO    MainThread:20169 [wandb_run.py:_restore():2287] restore
2025-08-05 02:55:15,976 INFO    MainThread:20169 [wandb_run.py:_restore():2293] restore done
2025-08-05 02:55:16,992 INFO    MainThread:20169 [wandb_run.py:_footer_history_summary_info():3936] rendering history
2025-08-05 02:55:16,992 INFO    MainThread:20169 [wandb_run.py:_footer_history_summary_info():3968] rendering summary
